<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>marine-obs.org | Coral Thermal Stress Monitor</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600&family=JetBrains+Mono:wght@500&family=Noto+Sans+JP:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --header-bg: #1a1f2e;
            --header-text: #ffffff;
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-card: #ffffff;
            --text-primary: #1a202c;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --accent-teal: #2b6cb0;
            --accent-coral: #996060;
            --accent-warm: #c05621;
            --accent-green: #2f855a;
            --border: #e2e8f0;
            --shadow: 0 1px 3px rgba(0,0,0,0.08);
            --chart-line-1: #2b6cb0;
            --chart-line-2: #c05621;
            --chart-line-3: #2f855a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'DM Sans', 'Noto Sans JP', sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        body.ja {
            font-family: 'Noto Sans JP', 'DM Sans', sans-serif;
        }

        /* Header */
        header {
            background: var(--header-bg);
            color: var(--header-text);
            padding: 0.75rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-weight: 600;
            font-size: 0.85rem;
            letter-spacing: -0.01em;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            color: inherit;
        }

        .logo-icon {
            overflow: hidden;
            width: 28px;
            height: 28px;
            background: linear-gradient(135deg, #5b9a94 0%, #2b6cb0 100%);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
            list-style: none;
        }

        .nav-links a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: color 0.2s;
        }

        .nav-links a:hover, .nav-links a.active {
            color: #ffffff;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .lang-switch {
            font-size: 0.8rem;
            display: flex;
            gap: 0.25rem;
        }

        .lang-switch button {
            background: none;
            border: none;
            color: rgba(255,255,255,0.6);
            cursor: pointer;
            font-size: 0.8rem;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .lang-switch button:hover {
            color: rgba(255,255,255,0.9);
        }

        .lang-switch button.active {
            color: #ffffff;
            background: rgba(255,255,255,0.15);
        }

        /* Main content */
        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2.5rem 2rem;
        }

        /* Page sections */
        .page-section {
            display: none;
        }

        .page-section.active {
            display: block;
        }

        /* Hero */
        .hero {
            margin-bottom: 2.5rem;
        }

        .hero h1 {
            font-size: 1.75rem;
            font-weight: 600;
            letter-spacing: -0.02em;
            line-height: 1.3;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        body.ja .hero h1 {
            font-size: 1.5rem;
            letter-spacing: 0;
        }

        .hero-subtitle {
            font-size: 0.85rem;
            color: var(--text-secondary);
            max-width: 720px;
            line-height: 1.7;
        }

        body.ja .hero-subtitle {
            line-height: 1.9;
        }

        /* Hero Visual Section */
.hero-visual {
    position: relative;
    min-height: 75vh;
    display: flex;
    align-items: center;
    margin: -2.5rem -2rem 3rem -2rem;
    padding: 4rem 2rem;
    background: linear-gradient(
        135deg, 
        rgba(26, 32, 46, 0.88) 0%, 
        rgba(26, 32, 46, 0.75) 50%,
        rgba(26, 32, 46, 0.65) 100%
    ), url('hero.jpg');
    background-size: cover;
    background-position: center;
    overflow: hidden;
}

.hero-visual-content {
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
    color: #ffffff;
}

.hero-visual h1 {
    font-size: 2.5rem;
    font-weight: 600;
    letter-spacing: -0.02em;
    line-height: 1.2;
    margin-bottom: 2rem;
    text-shadow: 0 2px 20px rgba(0,0,0,0.3);
}

body.ja .hero-visual h1 {
    font-size: 2.2rem;
    letter-spacing: 0.05em;
}

.hero-visual-text {
    font-size: 1.05rem;
    line-height: 2;
    max-width: 640px;
    color: rgba(255, 255, 255, 0.92);
    margin-bottom: 2rem;
}

body.ja .hero-visual-text {
    line-height: 2.2;
}

.hero-visual-text p {
    margin-bottom: 1.2rem;
}

.hero-visual-text p:last-child {
    margin-bottom: 0;
}

.hero-visual-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    color: #5b9a94;
    text-decoration: none;
    font-size: 0.95rem;
    font-weight: 500;
    transition: all 0.2s;
    margin-top: 1.5rem;
}

.hero-visual-link:hover {
    color: #7ab8b0;
    gap: 0.75rem;
}

.hero-visual-signature {
    font-size: 0.85rem;
    color: rgba(255, 255, 255, 0.55);
    font-style: italic;
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid rgba(255, 255, 255, 0.12);
    max-width: 640px;
}

.scroll-indicator {
    position: absolute;
    bottom: 2rem;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    color: rgba(255, 255, 255, 0.45);
    font-size: 0.75rem;
    animation: bounce 2s infinite;
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateX(-50%) translateY(0); }
    40% { transform: translateX(-50%) translateY(-8px); }
    60% { transform: translateX(-50%) translateY(-4px); }
}

@media (max-width: 768px) {
    .hero-visual {
        min-height: 85vh;
        padding: 3rem 1.5rem;
        margin: -2.5rem -1rem 2rem -1rem;
    }
    
    .hero-visual h1 {
        font-size: 1.75rem;
    }
    
    body.ja .hero-visual h1 {
        font-size: 1.6rem;
    }
    
    .hero-visual-text {
        font-size: 0.95rem;
    }
    
    .scroll-indicator {
        bottom: 1.5rem;
    }
}


.diver-cta-card .title {
    font-weight: 600;
    font-size: 0.95rem;
    color: var(--text-primary);
}

.diver-cta-card .desc {
    font-size: 0.8rem;
    color: var(--text-muted);
    line-height: 1.5;
}

.diver-cta-card.coming-soon {
    opacity: 0.6;
    pointer-events: none;
}

.diver-cta-card.coming-soon .title::after {
    content: ' (準備中)';
    font-size: 0.7rem;
    color: var(--text-muted);
    font-weight: normal;
}

body:not(.ja) .diver-cta-card.coming-soon .title::after {
    content: ' (Coming Soon)';
}

        /* Section titles */
        .section-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }


        /* KPI Multi-value layout */
        .kpi-value-multi {
            display: flex;
            flex-direction: column;
            gap: 0.35rem;
            margin: 0.5rem 0;
        }
        .kpi-site {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }
        .kpi-site strong {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.1rem;
            color: var(--text-primary);
        }
        .kpi-site strong.warning {
            color: var(--accent-warm);
        }
        .kpi-site strong.alert {
            color: var(--accent-coral);
        }
        .site-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        /* KPI Cards */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1rem;
            margin-bottom: 2.5rem;
        }

        .kpi-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.25rem 1.5rem;
            box-shadow: var(--shadow);
        }

        .kpi-label {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
        }

        .kpi-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 500;
            letter-spacing: -0.02em;
            line-height: 1;
            margin-bottom: 0.35rem;
            color: var(--text-primary);
        }

        .kpi-value.highlight { color: var(--accent-teal); }
        .kpi-value.warning { color: var(--accent-warm); }
        .kpi-value.alert { color: var(--accent-coral); }

        .kpi-context {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .kpi-unit {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-left: 0.15rem;
        }

        /* Chart cards */
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1rem;
            margin-bottom: 2.5rem;
        }

        .chart-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.25rem;
            box-shadow: var(--shadow);
        }

        .chart-header {
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--border);
        }

        .chart-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .chart-subtitle {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .chart-container {
            height: 200px;
            position: relative;
        }

        .chart-svg {
            width: 100%;
            height: 100%;
        }

        .chart-line {
            fill: none;
            stroke-width: 1.5;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .chart-line-1 { stroke: var(--chart-line-1); }
        .chart-line-2 { stroke: var(--chart-line-2); }
        .chart-line-3 { stroke: var(--chart-line-3); }

        .chart-grid-line {
            stroke: #e2e8f0;
            stroke-width: 1;
        }

        .chart-label {
            fill: var(--text-muted);
            font-size: 10px;
            font-family: 'JetBrains Mono', monospace;
        }

        .chart-legend {
            display: flex;
            gap: 1rem;
            margin-top: 0.75rem;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.35rem;
            font-size: 0.7rem;
            color: var(--text-secondary);
        }

        .legend-line {
            width: 16px;
            height: 2px;
        }

        .legend-line-1 { background: var(--chart-line-1); }
        .legend-line-2 { background: var(--chart-line-2); }
        .legend-line-3 { background: var(--chart-line-3); }

        /* Info grid */
        .info-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1rem;
        }

        @media (max-width: 768px) {
            .info-grid {
                grid-template-columns: 1fr;
            }
        }

        .info-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }

        .info-card h3 {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .info-card p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.75;
            margin-bottom: 0.75rem;
        }

        body.ja .info-card p {
            line-height: 1.9;
        }

        .info-card a.more-link {
            color: var(--accent-teal);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.85rem;
        }

        .info-card a.more-link:hover {
            text-decoration: underline;
        }

        /* Source list */
        .source-list {
            list-style: none;
        }

        .source-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.6rem 0;
            border-bottom: 1px solid var(--border);
            font-size: 0.85rem;
        }

        .source-item:last-child {
            border-bottom: none;
        }

        .source-name {
            color: var(--text-secondary);
        }

        .source-badge {
            font-size: 0.7rem;
            font-weight: 600;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            text-transform: uppercase;
            letter-spacing: 0.03em;
        }

        .source-badge.active {
            background: #d4e8e0;
            color: #2a4a3d;
        }

        .source-badge.pending {
            background: #feebc8;
            color: #6b5a3d;
        }

        /* About page */
        .about-content {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 2.5rem;
            box-shadow: var(--shadow);
            max-width: 800px;
        }

        .about-content h1 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 2rem;
            color: var(--text-primary);
        }

        body.ja .about-content h1 {
            font-size: 1.35rem;
        }

        .about-content h2 {
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        .about-content p {
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.85;
            margin-bottom: 1rem;
        }

        body.ja .about-content p {
            line-height: 2;
        }

        .about-signature {
            margin-top: 2.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border);
            font-size: 0.85rem;
            color: var(--text-muted);
            font-style: italic;
        }

        /* Glossary page */
        .glossary-grid {
            display: grid;
            gap: 1rem;
        }

        .glossary-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }

        .glossary-term {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .glossary-term-en {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-bottom: 0.75rem;
        }

        .glossary-def {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.75;
        }

        body.ja .glossary-def {
            line-height: 1.9;
        }

        .glossary-note {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
            padding-left: 0.75rem;
            border-left: 2px solid var(--border);
        }

        /* Footer */
        footer {
            background: var(--bg-card);
            border-top: 1px solid var(--border);
            padding: 1.5rem 2rem;
            margin-top: 2rem;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .footer-links {
            display: flex;
            gap: 1.5rem;
        }

        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
        }

        .footer-links a:hover {
            color: var(--accent-teal);
        }

        /* Responsive */
        @media (max-width: 640px) {
            header { padding: 0.75rem 1rem; }
            main { padding: 1.5rem 1rem; }
            .nav-links { display: none; }
            .chart-grid { grid-template-columns: 1fr; }
            .about-content { padding: 1.5rem; }
        }

        /* Language toggle */
        [data-lang="ja"] { display: none; }
        body.ja [data-lang="en"] { display: none; }
        body.ja [data-lang="ja"] { display: block; }
        span[data-lang="ja"], span[data-lang="en"] { display: inline; }
        body.ja span[data-lang="en"] { display: none; }
        body:not(.ja) span[data-lang="ja"] { display: none; }
    /* Dark mode support */
[data-theme="dark"] .six-card {
  background: #1e1e2e;
}
[data-theme="dark"] .six-card-title {
  color: #e0e0e0;
}
[data-theme="dark"] .six-card-desc {
  color: #a0a0a0;
}
@media (max-width: 900px) {
  .six-card-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}
@media (max-width: 600px) {
  .six-card-grid {
    grid-template-columns: 1fr;
  }
}/* Six Card Section - Marine Identity */
/* Marine Monitor Section */
.marine-monitor {
    margin: 2.5rem 0;
}

.marine-monitor-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.marine-monitor-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.marine-monitor-update {
    font-size: 0.75rem;
    color: var(--text-muted);
}

.marine-summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 0.75rem;
    margin-bottom: 1rem;
}

.marine-summary-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem;
    cursor: pointer;
    transition: all 0.2s;
}

.marine-summary-card:hover {
    border-color: var(--accent-teal);
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}

.marine-summary-card.expanded {
    border-color: var(--accent-teal);
}

.marine-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}

.marine-location {
    font-weight: 600;
    font-size: 0.95rem;
}

.marine-status {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.8rem;
}

.status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
}

.status-dot.good { background: #5a9a7a; }
.status-dot.caution { background: #ecc94b; }
.status-dot.warning { background: #f56565; }

.marine-summary-row {
    display: flex;
    gap: 1rem;
    font-size: 0.85rem;
    color: var(--text-secondary);
    flex-wrap: wrap;
}

.marine-summary-item {
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.marine-summary-item .label {
    color: var(--text-muted);
}

.marine-summary-item .value {
    font-weight: 500;
    color: var(--text-primary);
}

.marine-expand-icon {
    font-size: 0.7rem;
    color: var(--text-muted);
    transition: transform 0.2s;
}

.marine-summary-card.expanded .marine-expand-icon {
    transform: rotate(180deg);
}

.marine-detail {
    display: none;
    margin-top: 1rem;
    border-top: 1px solid var(--border);
    padding-top: 1rem;
}

.marine-summary-card.expanded .marine-detail {
    display: block;
}

.marine-day-group {
    margin-bottom: 1rem;
}

.marine-day-header {
    font-weight: 600;
    font-size: 0.85rem;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
    padding: 0.25rem 0.5rem;
    background: var(--bg-secondary);
    border-radius: 4px;
}

.marine-table {
    width: 100%;
    font-size: 0.75rem;
    border-collapse: collapse;
}

.marine-table th {
    text-align: left;
    color: var(--text-muted);
    font-weight: 500;
    padding: 0.25rem 0.5rem;
    border-bottom: 1px solid var(--border);
}

.marine-table td {
    padding: 0.25rem 0.5rem;
    border-bottom: 1px solid var(--border);
}

.marine-table tr:last-child td {
    border-bottom: none;
}

.wind-dir {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
}

@media (max-width: 640px) {
    .marine-summary-grid {
        grid-template-columns: 1fr;
    }
    .marine-summary-row {
        gap: 0.5rem;
    }
    .marine-table {
        font-size: 0.7rem;
    }
}

.six-card-section {
  padding: 2rem;
  max-width: 1400px;
  margin: 0 auto;
}
.six-card-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1.5rem;
}
.six-card {
  background: #ffffff;
  border-radius: 12px;
  padding: 0;
  box-shadow: 0 4px 20px rgba(0, 122, 108, 0.08);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  position: relative;
  transition: transform 0.3s, box-shadow 0.3s;
}
.six-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 30px rgba(0, 122, 108, 0.15);
}
.six-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #5b9a94, #3d7a73);
  z-index: 10;
}
.six-card.status-warning::before {
  background: linear-gradient(90deg, #c4a35a, #b8956a);
}
.six-card.status-alert::before {
  background: linear-gradient(90deg, #a65d5d, #8b5a5a);
  animation: pulse-alert 2s ease-in-out infinite;
}
@keyframes pulse-alert {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}
.six-card-badge {
  position: absolute;
  top: 12px;
  right: 12px;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 0.7rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  z-index: 20;
}
.badge-safe {
  background: rgba(78, 205, 196, 0.15);
  color: #3d7a73;
}
.badge-watch {
  background: rgba(249, 168, 37, 0.15);
  color: #f57c00;
}
.badge-alert {
  background: rgba(231, 76, 60, 0.15);
  color: #8b5a5a;
}
.six-card-chart {
  width: 100%;
  height: 180px;
  background: linear-gradient(180deg, rgba(78, 205, 196, 0.05) 0%, rgba(0, 122, 108, 0.1) 100%);
  position: relative;
  padding: 1rem;
  box-sizing: border-box;
}
.six-card-wave {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 20px;
  overflow: hidden;
}
.six-card-wave svg {
  position: absolute;
  bottom: 0;
  width: 100%;
  height: 20px;
}
.six-card-chart canvas {
  width: 100% !important;
  height: calc(100% - 10px) !important;
}
.six-card-body {
  padding: 1.25rem;
  flex: 1;
  display: flex;
  flex-direction: column;
  background: linear-gradient(180deg, #fff 0%, rgba(78, 205, 196, 0.02) 100%);
}
.six-card-title {
  font-size: 1.25rem;
  font-weight: 600;
  color: #1a1a2e;
  margin-bottom: 0.5rem;
  line-height: 1.3;
}
.six-card-location {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.8rem;
  color: #3d7a73;
  margin-bottom: 0.5rem;
}
.six-card-location svg {
  width: 14px;
  height: 14px;
  fill: #3d7a73;
}
.six-card-latest {
  font-size: 1.1rem;
  color: #1a1a2e;
  font-weight: 700;
  margin-bottom: 0.5rem;
}
.six-card-latest .trend-up {
  color: #a65d5d;
  font-size: 0.85rem;
}
.six-card-latest .trend-down {
  color: #4a8a6a;
  font-size: 0.85rem;
}
.six-card-desc {
  font-size: 0.85rem;
  color: #666;
  line-height: 1.6;
  margin-bottom: 1rem;
  flex: 1;
}
.six-card-btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 0.6rem 1.25rem;
  background: linear-gradient(135deg, #3d7a73, #2d5f5a);
  color: #fff;
  border-radius: 6px;
  text-decoration: none;
  font-size: 0.85rem;
  font-weight: 500;
  transition: all 0.2s;
  align-self: flex-start;
}
.six-card-btn:hover {
  background: linear-gradient(135deg, #2d5f5a, #1d4a45);
  gap: 12px;
}
.six-card-btn svg {
  width: 14px;
  height: 14px;
  fill: currentColor;
  transition: transform 0.2s;
}
.six-card-btn:hover svg {
  transform: translateX(2px);
}
.six-card.coming-soon {
  opacity: 0.6;
}
.six-card.coming-soon::before {
  background: linear-gradient(90deg, #bdc3c7, #95a5a6);
}
.six-card.coming-soon .six-card-chart {
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(180deg, #f5f5f5 0%, #e0e0e0 100%);
}
.six-card.coming-soon .coming-soon-label {
  font-size: 0.85rem;
  color: #95a5a6;
  font-weight: 600;
  letter-spacing: 1px;
}
.six-card.coming-soon .six-card-body {
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 60' opacity='0.03'%3E%3Cpath fill='%23007a6c' d='M20 60 Q25 40 20 30 Q15 20 25 10 M30 60 Q35 45 30 35 Q25 25 35 15 M45 60 Q50 50 45 40 Q40 30 50 20 M55 60 Q60 48 55 38 Q50 28 60 18 M70 60 Q75 42 70 32 Q65 22 75 12 M80 60 Q85 52 80 42 Q75 32 85 22'/%3E%3C/svg%3E") center bottom no-repeat;
  background-size: 80% auto;
}
[data-theme="dark"] .six-card {
  background: #1e1e2e;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
}
[data-theme="dark"] .six-card-chart {
  background: linear-gradient(180deg, rgba(78, 205, 196, 0.08) 0%, rgba(0, 122, 108, 0.15) 100%);
}
[data-theme="dark"] .six-card-body {
  background: linear-gradient(180deg, #1e1e2e 0%, rgba(78, 205, 196, 0.03) 100%);
}
[data-theme="dark"] .six-card-title {
  color: #e0e0e0;
}
[data-theme="dark"] .six-card-latest {
  color: #fff;
}
[data-theme="dark"] .six-card-desc {
  color: #a0a0a0;
}
[data-theme="dark"] .six-card-location {
  color: #5b9a94;
}
[data-theme="dark"] .six-card-location svg {
  fill: #5b9a94;
}
[data-theme="dark"] .badge-safe {
  background: rgba(78, 205, 196, 0.2);
  color: #5b9a94;
}
[data-theme="dark"] .six-card-wave svg path {
  fill: #1e1e2e;
}
@media (max-width: 1100px) {
  .six-card-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}
@media (max-width: 700px) {
  .six-card-grid {
    grid-template-columns: 1fr;
  }
}


/* Dark mode */
[data-theme="dark"] .six-card {
  background: #1e1e2e;
}
[data-theme="dark"] .six-card-chart {
  background: linear-gradient(135deg, #2a2a3e 0%, #1e1e2e 100%);
}
[data-theme="dark"] .six-card-title {
  color: #e0e0e0;
}
[data-theme="dark"] .six-card-latest {
  color: #5b9a94;
}
[data-theme="dark"] .six-card-desc {
  color: #a0a0a0;
}
@media (max-width: 1100px) {
  .six-card-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}
@media (max-width: 700px) {
  .six-card-grid {
    grid-template-columns: 1fr;
  }
}




/* Hero Impact Version */
.hero-impact {
    min-height: 90vh;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    text-align: center;
    background: linear-gradient(
        180deg,
        rgba(26, 32, 46, 0.7) 0%,
        rgba(26, 32, 46, 0.5) 50%,
        rgba(26, 32, 46, 0.7) 100%
    ), url('hero.jpg');
    background-size: cover;
    background-position: center;
    padding: 2rem;
}

.hero-spacer {
    height: 5vh;
}

.hero-body {
    display: flex;
    flex-direction: column;
    align-items: center;
    max-width: 900px;
}

.hero-footer {
    display: flex;
    gap: 1.5rem;
    flex-wrap: wrap;
    justify-content: center;
    padding-bottom: 8vh;
}

.hero-tagline {
    font-size: 3.2rem;
    font-weight: 700;
    letter-spacing: -0.02em;
    line-height: 1.3;
    color: #ffffff;
    text-shadow: 0 2px 20px rgba(0,0,0,0.5);
    margin-bottom: 2rem;
}

body.ja .hero-tagline {
    font-size: 2.4rem;
    letter-spacing: 0.05em;
    line-height: 1.5;
}

.hero-tagline-sub {
    display: block;
    margin-top: 0.75rem;
    font-weight: 500;
    color: rgba(255, 255, 255, 0.85);
    font-style: italic;
}

body.ja .hero-tagline-sub {
    font-style: normal;
    font-weight: 400;
    letter-spacing: 0.1em;
}



.hero-btn {
    padding: 0.7rem 1.5rem;
    border-radius: 6px;
    font-size: 0.85rem;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.3s ease;
    min-width: 150px;
    text-align: center;
}

.hero-btn-primary {
    background: #ffffff;
    color: #1a202c;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
}

.hero-btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
    background: #f0f0f0;
}

.hero-btn-secondary {
    background: transparent;
    color: rgba(255, 255, 255, 0.8);
    border: none;
    font-weight: 500;
    text-decoration: underline;
    text-underline-offset: 4px;
    min-width: auto;
    padding: 0.75rem 1rem;
}

.hero-btn-secondary:hover {
    color: #ffffff;
}

@media (max-width: 768px) {
    .hero-tagline {
        font-size: 2rem;
    }
    body.ja .hero-tagline {
        font-size: 1.75rem;
    }
    .hero-btn {
        min-width: 180px;
        padding: 0.875rem 2rem;
        font-size: 0.95rem;
    }
    .hero-btn-secondary {
        min-width: auto;
    }
    .hero-cta-buttons {
        flex-direction: column;
        align-items: center;
        gap: 0.75rem;
    }
}

</style>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <div class="header-content">
            <a href="#" class="logo" data-nav="home">
                <div class="logo-icon"><img src="logo.png" alt="marine-obs logo" style="width: 100%; height: 100%; object-fit: cover;"></div>
                <span>marine-obs.org</span>
            </a>
            <ul class="nav-links">
                <li>
                    <a href="#" data-nav="home" class="active">
                        <span data-lang="en">Dashboard</span>
                        <span data-lang="ja">ダッシュボード</span>
                    </a>
                </li>
                <li>
                    <a href="#" data-nav="about">
                        <span data-lang="en">About</span>
                        <span data-lang="ja">このサイトについて</span>
                    </a>
                </li>
                <li>
                    <a href="#" data-nav="divers">
                        <span data-lang="en">For Divers</span>
                        <span data-lang="ja">ダイバー向け</span>
                    </a>
                </li>
                <li>
                    <a href="#" data-nav="glossary">
                        <span data-lang="en">Glossary</span>
                        <span data-lang="ja">用語解説</span>
                    </a>
                </li>
            </ul>
            <div class="header-controls">
                <div class="lang-switch">
                    <button id="lang-en" class="active">EN</button>
                    <span style="color:rgba(255,255,255,0.4)">/</span>
                    <button id="lang-ja">日本語</button>
                </div>
            </div>
        </div>
    </header>

    <main>
        <!-- HOME / DASHBOARD -->
        <section class="page-section active" id="page-home">
            <!-- Hero Visual - Impact Version -->
            <section class="hero-visual hero-impact">
                <div class="hero-spacer"></div>
                
                <div class="hero-body">
                    <h1 class="hero-tagline" data-lang="en">Coral cannot speak.<span class="hero-tagline-sub">So we dive.</span></h1>
                    <h1 class="hero-tagline" data-lang="ja">サンゴは声を出せない。<span class="hero-tagline-sub">だから私たちが潜る。</span></h1>
                </div>
                
                <div class="hero-footer">
                    <a href="#" class="hero-btn hero-btn-primary" onclick="showPage('divers'); return false;">
                        <span data-lang="en">For Divers</span>
                        <span data-lang="ja">ダイバー向け情報</span>
                    </a>
                    <a href="#" class="hero-btn hero-btn-secondary" onclick="showPage('about'); return false;">
                        <span data-lang="en">About This Project</span>
                        <span data-lang="ja">このプロジェクトについて</span>
                    </a>
                </div>
            </section>

            <section class="kpi-grid">
                <!-- SST 3地点 -->
                <div class="kpi-card">
                    <div class="kpi-label">
                        <span data-lang="en">Latest SST</span>
                        <span data-lang="ja">最新海水温</span>
                    </div>
                    <div class="kpi-value-multi">
                        <div class="kpi-site"><span class="site-dot" style="background:#2b6cb0"></span><span data-lang="en">Sesoko</span><span data-lang="ja">瀬底</span> <strong>23.6</strong>℃</div>
                        <div class="kpi-site"><span class="site-dot" style="background:#c05621"></span><span data-lang="en">Manza</span><span data-lang="ja">万座</span> <strong>23.6</strong>℃</div>
                        <div class="kpi-site"><span class="site-dot" style="background:#2f855a"></span><span data-lang="en">Ogasawara</span><span data-lang="ja">小笠原</span> <strong>23.4</strong>℃</div>
                    </div>
                    <div class="kpi-context">
                        <span data-lang="en">Dec 27, 2025</span>
                        <span data-lang="ja">2025年12月27日</span>
                    </div>
                </div>
                <!-- DHW 2024 3地点 -->
                <div class="kpi-card">
                    <div class="kpi-label">
                        <span data-lang="en">Peak DHW 2025</span>
                        <span data-lang="ja">2025年 最大DHW</span>
                    </div>
                    <div class="kpi-value-multi">
                        <div class="kpi-site"><span class="site-dot" style="background:#2b6cb0"></span><span data-lang="en">Sesoko</span><span data-lang="ja">瀬底</span> <strong>0.6</strong></div>
                        <div class="kpi-site"><span class="site-dot" style="background:#c05621"></span><span data-lang="en">Manza</span><span data-lang="ja">万座</span> <strong>2.2</strong></div>
                        <div class="kpi-site"><span class="site-dot" style="background:#2f855a"></span><span data-lang="en">Ogasawara</span><span data-lang="ja">小笠原</span> <strong>2.8</strong></div>
                    </div>
                    <div class="kpi-context">
                        <span data-lang="en">°C-weeks · Alert at 4</span>
                        <span data-lang="ja">°C-weeks · 4以上で注意</span>
                    </div>
                </div>
                <!-- 高温日数 -->
                <div class="kpi-card">
                    <div class="kpi-label">
                        <span data-lang="en">Hot Days 2025</span>
                        <span data-lang="ja">高温日数 2025</span>
                    </div>
                    <div class="kpi-value-multi">
                        <div class="kpi-site"><span class="site-dot" style="background:#2b6cb0"></span><span data-lang="en">Sesoko</span><span data-lang="ja">瀬底</span> <strong>4</strong><span data-lang="en">d</span><span data-lang="ja">日</span></div>
                        <div class="kpi-site"><span class="site-dot" style="background:#c05621"></span><span data-lang="en">Manza</span><span data-lang="ja">万座</span> <strong>14</strong><span data-lang="en">d</span><span data-lang="ja">日</span></div>
                        <div class="kpi-site"><span class="site-dot" style="background:#2f855a"></span><span data-lang="en">Ogasawara</span><span data-lang="ja">小笠原</span> <strong>4</strong><span data-lang="en">d</span><span data-lang="ja">日</span></div>
                    </div>
                    <div class="kpi-context">
                        <span data-lang="en">Days ≥30°C</span>
                        <span data-lang="ja">30℃以上の日数</span>
                    </div>
                </div>
                <!-- 低温日数 -->
                <div class="kpi-card">
                    <div class="kpi-label">
                        <span data-lang="en">Cold Days 2025</span>
                        <span data-lang="ja">低温日数 2025</span>
                    </div>
                    <div class="kpi-value-multi">
                        <div class="kpi-site"><span class="site-dot" style="background:#2b6cb0"></span><span data-lang="en">Sesoko</span><span data-lang="ja">瀬底</span> <strong>0</strong><span data-lang="en">d</span><span data-lang="ja">日</span></div>
                        <div class="kpi-site"><span class="site-dot" style="background:#c05621"></span><span data-lang="en">Manza</span><span data-lang="ja">万座</span> <strong>0</strong><span data-lang="en">d</span><span data-lang="ja">日</span></div>
                        <div class="kpi-site"><span class="site-dot" style="background:#2f855a"></span><span data-lang="en">Ogasawara</span><span data-lang="ja">小笠原</span> <strong class="warning">49</strong><span data-lang="en">d</span><span data-lang="ja">日</span></div>
                    </div>
                    <div class="kpi-context">
                        <span data-lang="en">Days ≤20°C</span>
                        <span data-lang="ja">20℃以下の日数</span>
                    </div>
                </div>
            </section>

            <h2 class="section-title">
                <span data-lang="en">Indicators of Change</span>
                <span data-lang="ja">変化の指標</span>
            </h2>

            <section class="chart-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">
                            <span data-lang="en">Annual Peak DHW</span>
                            <span data-lang="ja">年間最大DHW</span>
                        </div>
                        <div class="chart-subtitle">
                            <span data-lang="en">Degree Heating Weeks · 3 Sites</span>
                            <span data-lang="ja">熱ストレス指標 · 3地点</span>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="dhwChart"></canvas>
                    </div>
                    <div class="chart-legend">
                        <div class="legend-item"><span class="legend-line legend-line-1"></span><span data-lang="en">Sesoko</span><span data-lang="ja">瀬底</span></div>
                        <div class="legend-item"><span class="legend-line legend-line-2"></span><span data-lang="en">Manza</span><span data-lang="ja">万座</span></div>
                        <div class="legend-item"><span class="legend-line legend-line-3"></span><span data-lang="en">Ogasawara</span><span data-lang="ja">小笠原</span></div>
                    </div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">
                            <span data-lang="en">Extreme Temperature Days</span>
                            <span data-lang="ja">極端水温日数</span>
                        </div>
                        <div class="chart-subtitle">
                            <span data-lang="en">Days ≥30°C · 3 Sites</span>
                            <span data-lang="ja">30℃以上の日数 · 3地点</span>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="extremeChart"></canvas>
                    </div>
                    <div class="chart-legend">
                        <div class="legend-item"><span class="legend-line legend-line-1"></span><span data-lang="en">Sesoko</span><span data-lang="ja">瀬底</span></div>
                        <div class="legend-item"><span class="legend-line legend-line-2"></span><span data-lang="en">Manza</span><span data-lang="ja">万座</span></div>
                        <div class="legend-item"><span class="legend-line legend-line-3"></span><span data-lang="en">Ogasawara</span><span data-lang="ja">小笠原</span></div>
                    </div>
                </div>
            </section>




            <section class="info-grid" style="grid-template-columns: 1fr;">
                <div class="info-card">
                    <h3>
                        <span data-lang="en">Data Sources</span>
                        <span data-lang="ja">データソース</span>
                    </h3>
                    <ul class="source-list">
                        <li class="source-item">
                            <span class="source-name">NOAA Coral Reef Watch</span>
                            <span class="source-badge active"><span data-lang="en">Active</span><span data-lang="ja">運用中</span></span>
                        </li>
                        <li class="source-item">
                            <span class="source-name">NASA MUR SST</span>
                            <span class="source-badge active"><span data-lang="en">Active</span><span data-lang="ja">運用中</span></span>
                        </li>
                        <li class="source-item">
                            <span class="source-name"><span data-lang="en">Monitoring Sites 1000</span><span data-lang="ja">モニタリングサイト1000</span></span>
                            <span class="source-badge pending">2025</span>
                        </li>
                        <li class="source-item">
                            <span class="source-name"><span data-lang="en">Turbidity Logger</span><span data-lang="ja">濁度計</span></span>
                            <span class="source-badge pending"><span data-lang="en">TBD</span><span data-lang="ja">検討中</span></span>
                        </li>
                    </ul>
                </div>
            </section>
        </section>

        <!-- DIVERS PAGE -->
        <section class="page-section" id="page-divers">
            <section class="hero">
                <h1 data-lang="en">For Divers</h1>
                <h1 data-lang="ja">ダイバー向け情報</h1>
                <p class="hero-subtitle" data-lang="en">
                    Sea conditions, observations, and resources for divers.
                </p>
                <p class="hero-subtitle" data-lang="ja">
                    海況情報、観察報告、ダイバーのためのリソース。
                </p>
            </section>

            <!-- Marine Monitor Section -->
            <section class="marine-monitor">
                <div class="marine-monitor-header">
                    <h2 class="marine-monitor-title">
                        <span data-lang="en">Marine Conditions</span><span data-lang="ja">海況モニター</span>
                    </h2>
                    <span class="marine-monitor-update" id="marine-update-time-divers"></span>
                </div>
                <div class="marine-summary-grid" id="marine-grid-divers">
                    <div style="color: var(--text-muted); padding: 2rem; text-align: center;">
                        <span data-lang="en">Loading...</span><span data-lang="ja">読み込み中...</span>
                    </div>
                </div>
            </section>

            <!-- Future: Observation Report Form -->
            <section class="info-card" style="margin-top: 2rem;">
                <h3>
                    <span data-lang="en">Report Your Observation</span>
                    <span data-lang="ja">観察を報告する</span>
                </h3>
                <p data-lang="en">Coming soon: Share what you see underwater—coral bleaching, unusual marine life, or changes in the reef. Your observations help build a community-driven picture of ocean health.</p>
                <p data-lang="ja">準備中：水中で見たものを共有してください。サンゴの白化、珍しい海洋生物、リーフの変化など。あなたの観察が、海の健康状態を知るための貴重なデータになります。</p>
            </section>
        </section>

        <!-- ABOUT PAGE -->
        <section class="page-section" id="page-about">
            <div class="about-content">
                <div data-lang="en">
                    <h1>About MarineObservations</h1>
                    <img src="diving.jpg" alt="Diving observation" style="width: 100%; max-width: 500px; border-radius: 12px; margin: 1.5rem 0; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                    
                    <h2>What I saw</h2>
                    <p>In the summer of 2024, I went diving in Onna Village, Okinawa. What I saw underwater stopped me cold: coral, bleached white, stretching across the reef. Not in patches—everywhere. The coral that local communities had spent years cultivating was gone.</p>
                    <p>I had heard about coral bleaching before. I knew the graphs, the rising temperatures, the warnings. None of it moved me to act. This did.</p>

                    <h2>Who I am</h2>
                    <p>I am a physician based in Japan. I am not a marine biologist, not an environmental scientist. But I dive—over a hundred times a year, in Okinawa, Ogasawara, the Maldives, and elsewhere. Diving is not my profession. It is how I stay connected to something larger than myself.</p>
                    <p>In my clinical work, I observe people over long periods of time. Change is slow, complex, and rarely reducible to simple cause and effect. Watching the ocean, I have come to feel, requires the same discipline: patient observation, careful recording, resistance to easy conclusions.</p>

                    <h2>Why this project</h2>
                    <p>Divers feel the change. "The coral is whiter than before." "There used to be more fish here." "The water is warmer." These observations come up constantly—over dinner, on the boat, between dives. But they remain impressions. They are not recorded, not accumulated, not shared beyond the moment.</p>
                    <p>MarineObservations is an attempt to change that. The goal is simple: to document what is happening in the waters where I dive, and to share it in a way that others can understand and use.</p>
                    <p>I am not here to tell anyone what to think. I have no political agenda—at least not yet. I do not know enough to take a position. What I do know is that understanding must come before judgment. First, observe. First, record. The rest can follow.</p>

                    <h2>Who this is for</h2>
                    <p>For anyone who wants to know what is happening beneath the surface.</p>
                    <p>For divers who sense the change but have not found a way to articulate it.</p>
                    <p>For those who believe that paying attention—even without expertise, even without authority—is itself a form of responsibility.</p>

                    <h2>Ten years from now</h2>
                    <p>If this project is still running in ten years, what would make it worthwhile?</p>
                    <p>A world where more people think about the ocean while enjoying its beauty. That would be enough.</p>

                    <p class="about-signature">MarineObservations is a project by a physician and diver, documenting ocean conditions from outside the boundaries of formal expertise.</p>
                </div>

                <div data-lang="ja">
                    <h1>MarineObservationsについて</h1>
                    <img src="diving.jpg" alt="海洋観測の様子" style="width: 100%; max-width: 500px; border-radius: 12px; margin: 1.5rem 0; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">

                    <h2>海に潜る瞬間</h2>
                    <p>東京で暮らしていると、自然を身体で感じる機会はほとんどない。だからこそ、海に潜った瞬間の感覚は格別である。一本目のエントリーで水中に入ると、全身の細胞が目を覚ますような感覚が走る。重力から解放され、聞こえるのは自分の呼吸音だけ。その感覚を求めて、私は潜り続けてきた。</p>
                    <p>本業は医師である。臨床の傍ら、国内外の海に年間100本以上潜っている。沖縄、小笠原、モルディブ——場所が変われば、海はまったく異なる表情を見せる。</p>

                    <h2>2024年、恩納村で見たもの</h2>
                    <p>転機は2024年の夏だった。</p>
                    <p>沖縄・恩納村の海に潜ったとき、異様な光景が広がっていた。サンゴが白い。それも一部ではなく、広範囲にわたってである。特に衝撃だったのは、地元の人々が長年かけて養殖してきたサンゴが、ほぼ全滅していたことだった。</p>
                    <p>正直に言えば、それまで地球温暖化という言葉は、どこか遠い政治的な議論として受け止めていた。しかし、目の前で白化したサンゴを見て、その認識は完全に覆った。これは政治の話ではない。今、この海で起きている現象なのだ。</p>

                    <h2>データと報道では動かなかった</h2>
                    <p>振り返れば、サンゴの白化に関する報道や研究データは以前から目にしていた。気温上昇のグラフも、海水温の変化も、知識としては知っていた。しかし、それらは私の行動を変えることはなかった。</p>
                    <p>変化が起きたのは、自分の目で見たあとだった。</p>
                    <p>この経験から、ひとつの確信を持つようになった。データや報道だけでは、人は必ずしも動かない。しかし、実際に見て、身体で感じたとき、初めて何かが変わる。少なくとも、私はそうだった。</p>

                    <h2>ダイバーは感じている、しかし</h2>
                    <p>海に潜るダイバーたちは、環境の変化を確実に感じ取っている。「サンゴが白くなっている」「昔はもっと魚がいた」「水温が高い」——そうした言葉は、ダイビング後の食事の席で頻繁に交わされる。</p>
                    <p>しかし、その先がない。感覚として共有されるだけで、言語化されず、記録にも残らない。「地球温暖化の影響かもしれないね」で会話は終わり、次の週にはまた別の海へ潜りに行く。</p>
                    <p>そこに、何かできる余地があるのではないか。そう考えるようになった。</p>

                    <h2>MarineObservationsという試み</h2>
                    <p>私は海洋生物学者でも環境科学者でもない。専門外の人間が環境観測に関わることに、どれほどの意味があるのかは、正直なところ分からない。</p>
                    <p>ただ、本業で長年続けてきた臨床の仕事と、環境の変化を見つめる行為との間に、不思議な共通点があることに気づいた。臨床では、人の変化を長期にわたって観察する。その変化は複雑な要因が絡み合い、すぐには可視化されない。環境の変化もまた、同じ構造を持っているように思える。</p>
                    <p>「観察」という行為が、両者をつないでいる。</p>

                    <h2>届けたい相手</h2>
                    <p>一般の人に、海で起きている変化を知ってほしい。</p>
                    <p>同時に、ダイバーたちと「何かができる」という感覚を共有したい。私たちはすでに変化を感じている。その感覚を言葉にし、記録し、データとして残すことで、新しい可能性が生まれるかもしれない。</p>

                    <h2>10年後に</h2>
                    <p>もしこのプロジェクトが10年続いたとしたら、何が実現していれば「やってよかった」と思えるだろうか。</p>
                    <p>海の美しさや自然の恩恵を享受しながら、人々が環境について自覚的に考えている。そうした姿勢が、ほんの少しでも広がっていれば、それで十分だと思っている。</p>

                    <p class="about-signature">MarineObservationsは、医師・ダイバーである筆者が、専門外の立場から海洋環境の観察と発信に取り組むプロジェクトです。</p>
                </div>
            </div>
        </section>

        <!-- GLOSSARY PAGE -->
        <section class="page-section" id="page-glossary">
            <section class="hero">
                <h1 data-lang="en">Glossary</h1>
                <h1 data-lang="ja">用語解説</h1>
                <p class="hero-subtitle" data-lang="en">Key terms used in coral thermal stress monitoring.</p>
                <p class="hero-subtitle" data-lang="ja">サンゴ熱ストレスモニタリングで使用される主な用語。</p>
            </section>

            <div class="glossary-grid">
                <div class="glossary-card">
                    <div class="glossary-term" data-lang="en">SST (Sea Surface Temperature)</div>
                    <div class="glossary-term" data-lang="ja">SST（海水温）</div>
                    <div class="glossary-term-en" data-lang="ja">Sea Surface Temperature</div>
                    <p class="glossary-def" data-lang="en">The temperature of the ocean's surface layer, typically measured by satellites. This site uses NASA MUR SST data at 1km resolution.</p>
                    <p class="glossary-def" data-lang="ja">海面付近の水温。衛星によって観測される。このサイトではNASA MUR SSTの1km解像度データを使用。</p>
                </div>

                <div class="glossary-card">
                    <div class="glossary-term" data-lang="en">MMM (Maximum Monthly Mean)</div>
                    <div class="glossary-term" data-lang="ja">MMM（月別最高平均水温）</div>
                    <div class="glossary-term-en" data-lang="ja">Maximum Monthly Mean</div>
                    <p class="glossary-def" data-lang="en">The highest monthly average SST at a location, calculated from historical data. Used as the baseline for measuring thermal stress. Sesoko: 29.0℃, Manza: 29.0℃.</p>
                    <p class="glossary-def" data-lang="ja">ある地点における月平均海水温の年間最高値。過去のデータから算出され、熱ストレスの基準値となる。瀬底：29.0℃、万座：29.0℃。</p>
                </div>

                <div class="glossary-card">
                    <div class="glossary-term" data-lang="en">DHW (Degree Heating Weeks)</div>
                    <div class="glossary-term" data-lang="ja">DHW（熱ストレス指標）</div>
                    <div class="glossary-term-en" data-lang="ja">Degree Heating Weeks</div>
                    <p class="glossary-def" data-lang="en">A measure of accumulated heat stress. Calculated by summing temperatures exceeding MMM+1℃ over the past 12 weeks. DHW ≥ 4: bleaching likely. DHW ≥ 8: severe bleaching and mortality likely.</p>
                    <p class="glossary-def" data-lang="ja">蓄積された熱ストレスの指標。過去12週間でMMM+1℃を超えた水温の累積値。DHW 4以上で白化の可能性、8以上で大規模白化・死亡の可能性。</p>
                    <p class="glossary-note" data-lang="en">Note: Satellite DHW tends to overestimate compared to in-situ measurements (2-3x higher in Sesoko studies).</p>
                    <p class="glossary-note" data-lang="ja">注：衛星DHWは現地観測より2〜3倍高く出る傾向がある（瀬底の研究による）。</p>
                </div>

                <div class="glossary-card">
                    <div class="glossary-term" data-lang="en">Coral Bleaching</div>
                    <div class="glossary-term" data-lang="ja">サンゴの白化</div>
                    <p class="glossary-def" data-lang="en">When stressed by high temperatures, corals expel their symbiotic algae (zooxanthellae), losing their color and primary energy source. Prolonged bleaching leads to mortality.</p>
                    <p class="glossary-def" data-lang="ja">高水温などのストレスにより、サンゴが共生藻（褐虫藻）を放出する現象。色が白くなり、主要なエネルギー源を失う。長期化すると死亡に至る。</p>
                </div>

                <div class="glossary-card">
                    <div class="glossary-term" data-lang="en">Bleaching Alert Levels</div>
                    <div class="glossary-term" data-lang="ja">白化警報レベル</div>
                    <p class="glossary-def" data-lang="en">NOAA's classification system based on thermal stress:</p>
                    <p class="glossary-def" data-lang="ja">NOAAによる熱ストレスの分類：</p>
                    <p class="glossary-def">
                        <span data-lang="en">• No Stress: SST below MMM<br>• Watch: SST exceeds MMM<br>• Warning: DHW > 0<br>• Alert Level 1: DHW ≥ 4<br>• Alert Level 2: DHW ≥ 8</span>
                        <span data-lang="ja">・ストレスなし：SSTがMMM未満<br>・注意：SSTがMMMを超過<br>・警戒：DHWが0を超過<br>・警報レベル1：DHW 4以上<br>・警報レベル2：DHW 8以上</span>
                    </p>
                </div>

                <div class="glossary-card">
                    <div class="glossary-term" data-lang="en">Thermal History</div>
                    <div class="glossary-term" data-lang="ja">熱履歴</div>
                    <p class="glossary-def" data-lang="en">The pattern of heat stress over multiple years. Research shows that corals exposed to moderate stress in one year may show increased short-term tolerance the following year.</p>
                    <p class="glossary-def" data-lang="ja">複数年にわたる熱ストレスのパターン。研究によると、前年に中程度のストレスを経験したサンゴは、翌年に短期的な耐熱性が向上することがある。</p>
                </div>

                <div class="glossary-card">
                    <div class="glossary-term" data-lang="en">NOAA Coral Reef Watch</div>
                    <div class="glossary-term" data-lang="ja">NOAA Coral Reef Watch</div>
                    <p class="glossary-def" data-lang="en">A program by the U.S. National Oceanic and Atmospheric Administration that provides global satellite monitoring of coral reef ecosystems and bleaching risk.</p>
                    <p class="glossary-def" data-lang="ja">米国海洋大気庁によるプログラム。衛星データを用いて世界のサンゴ礁生態系と白化リスクをモニタリング。</p>
                </div>

                <div class="glossary-card">
                    <div class="glossary-term" data-lang="en">Monitoring Sites 1000</div>
                    <div class="glossary-term" data-lang="ja">モニタリングサイト1000</div>
                    <p class="glossary-def" data-lang="en">A long-term ecological monitoring program by Japan's Ministry of the Environment, tracking biodiversity changes at 1,000 sites across Japan, including coral reefs.</p>
                    <p class="glossary-def" data-lang="ja">環境省による長期生態系モニタリング調査。日本全国約1,000箇所で生物多様性の変化を追跡。サンゴ礁も対象に含まれる。</p>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <div>
                <span data-lang="en">© 2024 marine-obs.org · Independent research project</span>
                <span data-lang="ja">© 2024 marine-obs.org · 個人プロジェクト</span>
            </div>
            <div class="footer-links">
                <a href="#">GitHub</a>
                <a href="#">Ko-fi</a>
                <a href="#" data-lang="en">Contact</a>
                <a href="#" data-lang="ja">お問い合わせ</a>
            </div>
        </div>
    </footer>

    <script>
        const body = document.body;
        const btnEn = document.getElementById('lang-en');
        const btnJa = document.getElementById('lang-ja');

        // Language
        function setLang(lang) {
            if (lang === 'ja') {
                body.classList.add('ja');
                btnJa.classList.add('active');
                btnEn.classList.remove('active');
                document.documentElement.lang = 'ja';
            } else {
                body.classList.remove('ja');
                btnEn.classList.add('active');
                btnJa.classList.remove('active');
                document.documentElement.lang = 'en';
            }
            localStorage.setItem('lang', lang);
        }

        btnEn.addEventListener('click', () => setLang('en'));
        btnJa.addEventListener('click', () => setLang('ja'));

        // Navigation
        const navLinks = document.querySelectorAll('[data-nav]');
        const pageSections = document.querySelectorAll('.page-section');

        function showPage(pageId) {
            pageSections.forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById('page-' + pageId).classList.add('active');

            navLinks.forEach(link => {
                if (link.tagName === 'A') {
                    link.classList.remove('active');
                    if (link.getAttribute('data-nav') === pageId) {
                        link.classList.add('active');
                    }
                }
            });

            window.scrollTo(0, 0);
        }

        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const pageId = link.getAttribute('data-nav');
                showPage(pageId);
            });
        });

        // Initialize
        const savedLang = localStorage.getItem('lang');
        if (savedLang) {
            setLang(savedLang);
        } else if (navigator.language.startsWith('ja')) {
            setLang('ja');
        }
    </script>
<!-- Six Card Section - Marine Identity -->
<section class="six-card-section">
  <div class="six-card-grid">
    <!-- Card 1: DHW（積算熱ストレス）- 3地点 -->
    <div class="six-card status-alert">
      <span class="six-card-badge badge-alert">
        <span data-lang="en">Alert</span>
        <span data-lang="ja">警報</span>
      </span>
      <div class="six-card-chart">
        <canvas id="chart-dhw-trend"></canvas>
        <div class="six-card-wave">
          <svg viewBox="0 0 1200 20" preserveAspectRatio="none">
            <path d="M0,10 Q150,0 300,10 T600,10 T900,10 T1200,10 L1200,20 L0,20 Z" fill="#ffffff"/>
          </svg>
        </div>
      </div>
      <div class="six-card-body">
        <div class="six-card-title">
          <span data-lang="en">Degree Heating Weeks</span>
          <span data-lang="ja">積算熱ストレス (DHW)</span>
        </div>
        <div class="six-card-location">
          <svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
          <span data-lang="en">Sesoko · Manza · Ogasawara</span>
          <span data-lang="ja">瀬底・万座・小笠原</span>
        </div>
        <div class="six-card-latest">
          <span data-lang="en">2025 Peak: 0.6 / 2.2 / 2.8</span>
          <span data-lang="ja">2025年ピーク: 0.6 / 2.2 / 2.8</span>
        </div>
        <div class="six-card-desc">
          <span data-lang="en">Manza exceeded Watch Level (DHW 4). Annual peak comparison across 3 sites.</span>
          <span data-lang="ja">万座が注意レベル（DHW 4）を超過。3地点の年別ピークを比較。</span>
        </div>
        <a href="#" class="six-card-btn">
          <span data-lang="en">Explore data</span>
          <span data-lang="ja">データを見る</span>
          <svg viewBox="0 0 24 24"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>
        </a>
      </div>
    </div>

    <!-- Card 2: SST（海水温）- 3地点 -->
    <div class="six-card status-warning">
      <span class="six-card-badge badge-watch">
        <span data-lang="en">Watch</span>
        <span data-lang="ja">注意</span>
      </span>
      <div class="six-card-chart">
        <canvas id="chart-sst-compare"></canvas>
        <div class="six-card-wave">
          <svg viewBox="0 0 1200 20" preserveAspectRatio="none">
            <path d="M0,10 Q150,0 300,10 T600,10 T900,10 T1200,10 L1200,20 L0,20 Z" fill="#ffffff"/>
          </svg>
        </div>
      </div>
      <div class="six-card-body">
        <div class="six-card-title">
          <span data-lang="en">Sea Surface Temperature</span>
          <span data-lang="ja">海水温 (SST)</span>
        </div>
        <div class="six-card-location">
          <svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
          <span data-lang="en">Sesoko · Manza · Ogasawara</span>
          <span data-lang="ja">瀬底・万座・小笠原</span>
        </div>
        <div class="six-card-latest">
          <span data-lang="en">Latest: 23.6 / 23.6 / 23.4°C</span>
          <span data-lang="ja">最新: 23.6 / 23.6 / 23.4°C</span>
        </div>
        <div class="six-card-desc">
          <span data-lang="en">Monthly climatology comparison. Okinawa peaks in August, Ogasawara in September.</span>
          <span data-lang="ja">月別気候値の比較。沖縄は8月、小笠原は9月にピーク。</span>
        </div>
        <a href="#" class="six-card-btn">
          <span data-lang="en">Explore data</span>
          <span data-lang="ja">データを見る</span>
          <svg viewBox="0 0 24 24"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>
        </a>
      </div>
    </div>

    <!-- Card 3: 極端日数 - 3地点 -->
    <div class="six-card">
      <span class="six-card-badge badge-safe">
        <span data-lang="en">Normal</span>
        <span data-lang="ja">平常</span>
      </span>
      <div class="six-card-chart">
        <canvas id="extremeChartMini"></canvas>
        <div class="six-card-wave">
          <svg viewBox="0 0 1200 20" preserveAspectRatio="none">
            <path d="M0,10 Q150,0 300,10 T600,10 T900,10 T1200,10 L1200,20 L0,20 Z" fill="#ffffff"/>
          </svg>
        </div>
      </div>
      <div class="six-card-body">
        <div class="six-card-title">
          <span data-lang="en">Extreme Temperature Days</span>
          <span data-lang="ja">極端水温日数</span>
        </div>
        <div class="six-card-location">
          <svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
          <span data-lang="en">Sesoko · Manza · Ogasawara</span>
          <span data-lang="ja">瀬底・万座・小笠原</span>
        </div>
        <div class="six-card-latest">
          <span data-lang="en">2025: 4 / 14 / 4 hot days</span>
          <span data-lang="ja">2025年: 4 / 14 / 4 高温日</span>
        </div>
        <div class="six-card-desc">
          <span data-lang="en">Days ≥30°C (hot) and ≤20°C (cold). Ogasawara shows distinct cold-water pattern.</span>
          <span data-lang="ja">30℃以上（高温）と20℃以下（低温）の日数。小笠原は低温パターンが特徴的。</span>
        </div>
        <a href="#" class="six-card-btn">
          <span data-lang="en">Explore data</span>
          <span data-lang="ja">データを見る</span>
          <svg viewBox="0 0 24 24"><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>
        </a>
      </div>
    </div>

    <!-- Card 4: 種別脆弱性 (Coming Soon) -->
    <div class="six-card coming-soon">
      <div class="six-card-chart">
        <span class="coming-soon-label">COMING SOON</span>
      </div>
      <div class="six-card-body">
        <div class="six-card-title">
          <span data-lang="en">Species Vulnerability</span>
          <span data-lang="ja">種別脆弱性</span>
        </div>
        <div class="six-card-location">
          <svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
          <span data-lang="en">Acropora · Montipora · Porites</span>
          <span data-lang="ja">ミドリイシ・コモンサンゴ・ハマサンゴ</span>
        </div>
        <div class="six-card-desc">
          <span data-lang="en">Differential bleaching susceptibility by coral genus. Winners vs. losers framework.</span>
          <span data-lang="ja">サンゴ属ごとの白化感受性の違い。勝者と敗者の構造。</span>
        </div>
      </div>
    </div>

    <!-- Card 5: モニ1000 (Coming Soon) -->
    <div class="six-card coming-soon">
      <div class="six-card-chart">
        <span class="coming-soon-label">COMING SOON</span>
      </div>
      <div class="six-card-body">
        <div class="six-card-title">
          <span data-lang="en">Monitoring Sites 1000</span>
          <span data-lang="ja">モニタリングサイト1000</span>
        </div>
        <div class="six-card-location">
          <svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
          <span data-lang="en">Nationwide, Japan</span>
          <span data-lang="ja">全国</span>
        </div>
        <div class="six-card-desc">
          <span data-lang="en">Integration with Japan's national coral reef monitoring network (MOE).</span>
          <span data-lang="ja">環境省モニタリングサイト1000サンゴ礁調査との連携。</span>
        </div>
      </div>
    </div>

    <!-- Card 6: 濁度観測 (Coming Soon) -->
    <div class="six-card coming-soon">
      <div class="six-card-chart">
        <span class="coming-soon-label">COMING SOON</span>
      </div>
      <div class="six-card-body">
        <div class="six-card-title">
          <span data-lang="en">Turbidity Monitoring</span>
          <span data-lang="ja">濁度観測</span>
        </div>
        <div class="six-card-location">
          <svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
          <span data-lang="en">Okinawa coastal stations</span>
          <span data-lang="ja">沖縄沿岸観測点</span>
        </div>
        <div class="six-card-desc">
          <span data-lang="en">In-situ NTU measurements and satellite Kd(490) for sediment stress assessment.</span>
          <span data-lang="ja">実測NTUと衛星Kd(490)による堆積物ストレス評価。</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- SST Chart Data (Generated from NASA MUR SST 2002-2024) -->
<script>
const CHART_DATA = {
  dhw_trend: {
    labels: ['2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024'],
    datasets: {
      sesoko: [0.3, 8.3, 9.7, 0.3, 0.6, 3.1, 0.8, 5.0, 2.1, 9.8],
      manza: [0.8, 8.6, 9.7, 1.2, 1.7, 3.3, 1.0, 5.1, 2.4, 10.9],
      ogasawara: [0.3, 0.3, 2.9, 2.3, 1.1, 9.6, 3.4, 4.5, 1.4, 4.1]
    }
  },
  sst_monthly: {
    labels: ['J', 'F', 'M', 'A', 'M', 'J', 'J', 'A', 'S', 'O', 'N', 'D'],
    sesoko: {
      '2024': [23.1, 22.7, 22.1, 23.2, 24.7, 26.5, 29.8, 29.9, 29.5, 28.1, 26.9, 24.7],
      '2023': [22.1, 21.7, 22.4, 23.0, 24.7, 26.6, 28.9, 28.2, 29.1, 27.5, 25.8, 24.1],
      mmm: 29.0
    },
    manza: {
      '2024': [22.5, 22.1, 21.6, 23.0, 24.7, 26.0, 29.7, 30.2, 29.4, 28.3, 26.5, 24.1],
      '2023': [21.9, 21.3, 21.9, 22.8, 24.2, 26.5, 29.0, 28.1, 29.2, 27.6, 25.5, 23.7],
      mmm: 29.0
    }
  },
  site_compare: {
    labels: ['Jun', 'Jul', 'Aug', 'Sep'],
    sesoko: [26.5, 29.8, 29.9, 29.5],
    manza: [26.0, 29.7, 30.2, 29.4],
    ogasawara: [26.3, 29.0, 28.4, 28.0]
  }
};

// DHW色分け（閾値: 4未満=緑, 4-8=黄, 8以上=赤）
function getDHWColors(values) {
  return values.map(v => v >= 8 ? '#a65d5d' : v >= 4 ? '#c4a35a' : '#5b9a94');
}

document.addEventListener('DOMContentLoaded', function() {
  // DHW年別推移（万座）
  const ctxDHW = document.getElementById('chart-dhw-trend');
  if (ctxDHW) {
    const dhwData = CHART_DATA.dhw_trend.datasets.manza;
    new Chart(ctxDHW, {
      type: 'bar',
      data: {
        labels: CHART_DATA.dhw_trend.labels,
        datasets: [{
          data: dhwData,
          backgroundColor: getDHWColors(dhwData),
          borderRadius: 4
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        scales: {
          y: { beginAtZero: true, max: 12, grid: { color: 'rgba(0,122,108,0.08)' }, ticks: { font: { size: 10 }, color: '#666' } },
          x: { grid: { display: false }, ticks: { font: { size: 10 }, color: '#666' } }
        }
      }
    });
  }

  // SST月別比較（万座 2024 vs 2023）
  const ctxSST = document.getElementById('chart-sst-compare');
  if (ctxSST) {
    const sst = CHART_DATA.sst_monthly.manza;
    new Chart(ctxSST, {
      type: 'line',
      data: {
        labels: CHART_DATA.sst_monthly.labels,
        datasets: [
          {
            label: '2024',
            data: sst['2024'],
            borderColor: '#a65d5d',
            backgroundColor: 'rgba(231,76,60,0.1)',
            fill: true,
            tension: 0.4,
            pointRadius: 0,
            borderWidth: 2
          },
          {
            label: '2023',
            data: sst['2023'],
            borderColor: '#3498db',
            borderDash: [5, 5],
            fill: false,
            tension: 0.4,
            pointRadius: 0,
            borderWidth: 2
          },
          {
            label: 'MMM',
            data: Array(12).fill(sst.mmm),
            borderColor: '#3d7a73',
            borderDash: [2, 2],
            fill: false,
            pointRadius: 0,
            borderWidth: 1
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: true, position: 'bottom', labels: { boxWidth: 10, font: { size: 9 }, padding: 8 } } },
        scales: {
          y: { min: 20, max: 32, grid: { color: 'rgba(0,122,108,0.08)' }, ticks: { font: { size: 9 }, color: '#666' } },
          x: { grid: { display: false }, ticks: { font: { size: 9 }, color: '#666', maxRotation: 0 } }
        }
      }
    });
  }

  // 地点間比較（2024年夏季、3地点）
  const ctxSite = document.getElementById('chart-site-compare');
  if (ctxSite) {
    const sc = CHART_DATA.site_compare;
    new Chart(ctxSite, {
      type: 'bar',
      data: {
        labels: sc.labels,
        datasets: [
          { label: 'Sesoko', data: sc.sesoko, backgroundColor: '#5b9a94', borderRadius: 4 },
          { label: 'Manza', data: sc.manza, backgroundColor: '#3498db', borderRadius: 4 },
          { label: 'Ogasawara', data: sc.ogasawara, backgroundColor: '#9b59b6', borderRadius: 4 }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: true, position: 'bottom', labels: { boxWidth: 10, font: { size: 9 }, padding: 8 } } },
        scales: {
          y: { min: 24, max: 32, grid: { color: 'rgba(0,122,108,0.08)' }, ticks: { font: { size: 9 }, color: '#666' } },
          x: { grid: { display: false }, ticks: { font: { size: 9 }, color: '#666' } }
        }
      }
    });
  }
});
</script>

<script>
// Marine Monitor - Supabase Data Fetcher
(function() {
    const SUPABASE_URL = 'https://pegiuiblpliainpdggfj.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBlZ2l1aWJscGxpYWlucGRnZ2ZqIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2NDIwOTM3NCwiZXhwIjoyMDc5Nzg1Mzc0fQ.V3C2newkAdn6gW2TR_ct-_WupVKZapXKtD9Cr3aMk2M';
    
    const LOCATIONS = [
        { id: 'okinawa_sesoko', name: '瀬底', nameEn: 'Sesoko' },
        { id: 'okinawa_manza', name: '万座', nameEn: 'Manza' },
        { id: 'ogasawara', name: '小笠原', nameEn: 'Ogasawara' }
    ];
    
    const WEEKDAYS_JA = ['日', '月', '火', '水', '木', '金', '土'];
    const WEEKDAYS_EN = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    
    function degToDirection(deg) {
        if (deg === null || deg === undefined) return '-';
        const dirs = ['北', '北東', '東', '南東', '南', '南西', '西', '北西'];
        const dirsEn = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];
        const idx = Math.round(deg / 45) % 8;
        return { ja: dirs[idx], en: dirsEn[idx] };
    }
    
    function getSeaStatus(waveHeight, swellHeight, windSpeed) {
        const totalWave = (waveHeight || 0) + (swellHeight || 0);
        const wind = windSpeed || 0;
        if (totalWave >= 2.0 || wind >= 12) return { class: 'warning', textJa: '荒れ', textEn: 'Rough' };
        if (totalWave >= 1.0 || wind >= 8) return { class: 'caution', textJa: '注意', textEn: 'Caution' };
        return { class: 'good', textJa: '良好', textEn: 'Good' };
    }
    
    async function fetchMarineData() {
        const now = new Date();
        const start = new Date(now);
        start.setHours(0, 0, 0, 0);
        const end = new Date(start);
        end.setDate(end.getDate() + 4);
        
        const startISO = start.toISOString();
        const endISO = end.toISOString();
        
        const results = {};
        
        for (const loc of LOCATIONS) {
            const url = `${SUPABASE_URL}/rest/v1/marine_weather?location=eq.${loc.id}&datetime=gte.${startISO}&datetime=lt.${endISO}&order=datetime.asc&select=datetime,water_temperature,wave_height,swell_height,wind_speed,wind_direction,air_temperature,visibility`;
            
            try {
                const resp = await fetch(url, {
                    headers: {
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
                    }
                });
                const data = await resp.json();
                results[loc.id] = data;
            } catch (e) {
                console.error(`Error fetching ${loc.id}:`, e);
                results[loc.id] = [];
            }
        }
        
        return results;
    }
    
    function groupByDate(data) {
        const groups = {};
        for (const row of data) {
            const dt = new Date(row.datetime);
            const hour = dt.getUTCHours() + 9; // JST
            if (hour < 7 || hour > 17) continue; // 7:00-17:00 JST only
            
            const dateKey = dt.toISOString().slice(0, 10);
            if (!groups[dateKey]) groups[dateKey] = [];
            groups[dateKey].push({
                hour: hour,
                waterTemp: row.water_temperature,
                waveHeight: row.wave_height,
                swellHeight: row.swell_height,
                windSpeed: row.wind_speed,
                windDir: row.wind_direction,
                airTemp: row.air_temperature,
                visibility: row.visibility
            });
        }
        return groups;
    }
    
    function calcDailySummary(dayData) {
        if (!dayData || dayData.length === 0) return null;
        
        const waterTemps = dayData.map(d => d.waterTemp).filter(v => v != null);
        const waves = dayData.map(d => d.waveHeight).filter(v => v != null);
        const swells = dayData.map(d => d.swellHeight).filter(v => v != null);
        const winds = dayData.map(d => d.windSpeed).filter(v => v != null);
        const windDirs = dayData.map(d => d.windDir).filter(v => v != null);
        
        return {
            waterTemp: waterTemps.length ? (waterTemps.reduce((a,b) => a+b) / waterTemps.length) : null,
            waveMax: waves.length ? Math.max(...waves) : null,
            swellMax: swells.length ? Math.max(...swells) : null,
            windMax: winds.length ? Math.max(...winds) : null,
            windDirAvg: windDirs.length ? (windDirs.reduce((a,b) => a+b) / windDirs.length) : null
        };
    }
    
    function renderCards(data) {
        const grid = document.getElementById('marine-grid');
        if (!grid) return;
        
        const isJa = document.body.classList.contains('ja');
        let html = '';
        
        for (const loc of LOCATIONS) {
            const locData = data[loc.id] || [];
            const grouped = groupByDate(locData);
            const dates = Object.keys(grouped).sort().slice(0, 4);
            
            if (dates.length === 0) {
                html += `<div class="marine-summary-card"><div class="marine-location">${isJa ? loc.name : loc.nameEn}</div><div style="color:var(--text-muted)">No data</div></div>`;
                continue;
            }
            
            // Today's summary
            const todaySummary = calcDailySummary(grouped[dates[0]]);
            const status = todaySummary ? getSeaStatus(todaySummary.waveMax, todaySummary.swellMax, todaySummary.windMax) : { class: 'good', textJa: '-', textEn: '-' };
            const windDir = todaySummary ? degToDirection(todaySummary.windDirAvg) : { ja: '-', en: '-' };
            
            html += `
            <div class="marine-summary-card" onclick="this.classList.toggle('expanded')">
                <div class="marine-card-header">
                    <span class="marine-location">${isJa ? loc.name : loc.nameEn}</span>
                    <div class="marine-status">
                        <span class="status-dot ${status.class}"></span>
                        <span>${isJa ? status.textJa : status.textEn}</span>
                        <span class="marine-expand-icon">▼</span>
                    </div>
                </div>
                <div class="marine-summary-row">
                    <div class="marine-summary-item">
                        <span class="label">${isJa ? '水温' : 'Water'}</span>
                        <span class="value">${todaySummary?.waterTemp?.toFixed(1) || '-'}℃</span>
                    </div>
                    <div class="marine-summary-item">
                        <span class="label">${isJa ? '波' : 'Wave'}</span>
                        <span class="value">${todaySummary?.waveMax?.toFixed(1) || '-'}m</span>
                    </div>
                    <div class="marine-summary-item">
                        <span class="label">${isJa ? '風' : 'Wind'}</span>
                        <span class="value">${todaySummary?.windMax?.toFixed(0) || '-'}m/s ${isJa ? windDir.ja : windDir.en}</span>
                    </div>
                </div>
                <div class="marine-detail">
                    ${renderDetailTables(grouped, dates, isJa)}
                </div>
            </div>`;
        }
        
        grid.innerHTML = html;
        
        // Update time
        const updateEl = document.getElementById('marine-update-time');
        if (updateEl) {
            const now = new Date();
            updateEl.textContent = isJa 
                ? `更新: ${now.getMonth()+1}/${now.getDate()} ${now.getHours()}:${String(now.getMinutes()).padStart(2,'0')}`
                : `Updated: ${now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })}`;
        }
    }
    
    function renderDetailTables(grouped, dates, isJa) {
        let html = '';
        
        for (const dateKey of dates) {
            const dayData = grouped[dateKey];
            if (!dayData || dayData.length === 0) continue;
            
            const dt = new Date(dateKey + 'T00:00:00Z');
            const wd = isJa ? WEEKDAYS_JA[dt.getUTCDay()] : WEEKDAYS_EN[dt.getUTCDay()];
            const dateLabel = `${dt.getUTCMonth()+1}/${dt.getUTCDate()} (${wd})`;
            
            html += `
            <div class="marine-day-group">
                <div class="marine-day-header">${dateLabel}</div>
                <table class="marine-table">
                    <thead>
                        <tr>
                            <th>${isJa ? '時刻' : 'Time'}</th>
                            <th>${isJa ? '波高' : 'Wave'}</th>
                            <th>${isJa ? 'うねり' : 'Swell'}</th>
                            <th>${isJa ? '風' : 'Wind'}</th>
                            <th>${isJa ? '水温' : 'Temp'}</th>
                        </tr>
                    </thead>
                    <tbody>`;
            
            for (const row of dayData) {
                const windDir = degToDirection(row.windDir);
                html += `
                        <tr>
                            <td>${row.hour}:00</td>
                            <td>${row.waveHeight?.toFixed(1) || '-'}m</td>
                            <td>${row.swellHeight?.toFixed(1) || '-'}m</td>
                            <td class="wind-dir">${row.windSpeed?.toFixed(0) || '-'}m/s <span style="color:var(--text-muted)">${isJa ? windDir.ja : windDir.en}</span></td>
                            <td>${row.waterTemp?.toFixed(1) || '-'}℃</td>
                        </tr>`;
            }
            
            html += `
                    </tbody>
                </table>
            </div>`;
        }
        
        return html;
    }
    
    // Render to a specific grid
    function renderToGrid(gridId, updateId, data) {
        const grid = document.getElementById(gridId);
        if (!grid) return;
        
        const isJa = document.body.classList.contains('ja');
        let html = '';
        
        for (const loc of LOCATIONS) {
            const locData = data[loc.id] || [];
            const grouped = groupByDate(locData);
            const dates = Object.keys(grouped).sort().slice(0, 4);
            
            if (dates.length === 0) {
                html += `<div class="marine-summary-card"><div class="marine-location">${isJa ? loc.name : loc.nameEn}</div><div style="color:var(--text-muted)">No data</div></div>`;
                continue;
            }
            
            const todaySummary = calcDailySummary(grouped[dates[0]]);
            const status = todaySummary ? getSeaStatus(todaySummary.waveMax, todaySummary.swellMax, todaySummary.windMax) : { class: 'good', textJa: '-', textEn: '-' };
            const windDir = todaySummary ? degToDirection(todaySummary.windDirAvg) : { ja: '-', en: '-' };
            
            html += `
            <div class="marine-summary-card" onclick="this.classList.toggle('expanded')">
                <div class="marine-card-header">
                    <span class="marine-location">${isJa ? loc.name : loc.nameEn}</span>
                    <div class="marine-status">
                        <span class="status-dot ${status.class}"></span>
                        <span>${isJa ? status.textJa : status.textEn}</span>
                        <span class="marine-expand-icon">▼</span>
                    </div>
                </div>
                <div class="marine-summary-row">
                    <div class="marine-summary-item">
                        <span class="label">${isJa ? '水温' : 'Water'}</span>
                        <span class="value">${todaySummary?.waterTemp?.toFixed(1) || '-'}℃</span>
                    </div>
                    <div class="marine-summary-item">
                        <span class="label">${isJa ? '波' : 'Wave'}</span>
                        <span class="value">${todaySummary?.waveMax?.toFixed(1) || '-'}m</span>
                    </div>
                    <div class="marine-summary-item">
                        <span class="label">${isJa ? '風' : 'Wind'}</span>
                        <span class="value">${todaySummary?.windMax?.toFixed(0) || '-'}m/s ${isJa ? windDir.ja : windDir.en}</span>
                    </div>
                </div>
                <div class="marine-detail">
                    ${renderDetailTables(grouped, dates, isJa)}
                </div>
            </div>`;
        }
        
        grid.innerHTML = html;
        
        const updateEl = document.getElementById(updateId);
        if (updateEl) {
            const now = new Date();
            updateEl.textContent = isJa 
                ? `更新: ${now.getMonth()+1}/${now.getDate()} ${now.getHours()}:${String(now.getMinutes()).padStart(2,'0')}`
                : `Updated: ${now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })}`;
        }
    }
    
    // Initialize
    document.addEventListener('DOMContentLoaded', async () => {
        const data = await fetchMarineData();
        
        // Render to divers page
        renderToGrid('marine-grid-divers', 'marine-update-time-divers', data);
        
        // Re-render on language change
        const observer = new MutationObserver(() => {
            renderToGrid('marine-grid-divers', 'marine-update-time-divers', data);
        });
        observer.observe(document.body, { attributes: true, attributeFilter: ['class'] });
    });
})();
</script>

<!-- Chart.js Data Initialization -->
<script>
(function() {
    // Chart.js default settings
    Chart.defaults.font.family = "'Noto Sans JP', -apple-system, BlinkMacSystemFont, sans-serif";
    Chart.defaults.font.size = 11;
    
    const chartColors = {
        sesoko: '#2b6cb0',
        manza: '#c05621', 
        ogasawara: '#2f855a'
    };
    
    let dhwChart = null;
    // extremeChart loaded via fetch
    
    async function initCharts() {
        try {
            // Load JSON data
            const [dhwData, climData] = await Promise.all([
                fetch('data/dhw_annual_peak.json').then(r => r.json()),
                fetch('data/monthly_clim.json').then(r => r.json())
            ]);
            
            // DHW Chart
            const dhwCtx = document.getElementById('dhwChart');
            if (dhwCtx) {
                const years = dhwData.sesoko.map(d => d.year);
                
                dhwChart = new Chart(dhwCtx, {
                    type: 'bar',
                    data: {
                        labels: years,
                        datasets: [
                            {
                                label: '瀬底',
                                data: dhwData.sesoko.map(d => d.peak_dhw),
                                backgroundColor: chartColors.sesoko + '99',
                                borderColor: chartColors.sesoko,
                                borderWidth: 1
                            },
                            {
                                label: '万座',
                                data: dhwData.manza.map(d => d.peak_dhw),
                                backgroundColor: chartColors.manza + '99',
                                borderColor: chartColors.manza,
                                borderWidth: 1
                            },
                            {
                                label: '小笠原',
                                data: dhwData.ogasawara.map(d => d.peak_dhw),
                                backgroundColor: chartColors.ogasawara + '99',
                                borderColor: chartColors.ogasawara,
                                borderWidth: 1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: (ctx) => `${ctx.dataset.label}: ${ctx.raw.toFixed(2)} °C-weeks`
                                }
                            }
                        },
                        scales: {
                            x: {
                                grid: { display: false },
                                ticks: { 
                                    maxRotation: 0,
                                    callback: function(val, idx) {
                                        const year = this.getLabelForValue(val);
                                        return (year % 5 === 0) ? year : '';
                                    }
                                }
                            },
                            y: {
                                beginAtZero: true,
                                max: 10,
                                grid: { color: '#e2e8f0' },
                                ticks: {
                                    stepSize: 2
                                }
                            }
                        }
                    }
                });
            }
            
            // Extreme Days Chart (Hot Days ≥30°C)
            const extremeCtx = document.getElementById('extremeChart');
            if (extremeCtx) {
                // Load extreme days data
                fetch('data/extreme_days.json')
                    .then(res => res.json())
                    .then(extremeData => {
                        const years = extremeData.hot_days.sesoko.map(d => d.year);
                        new Chart(extremeCtx, {
                            type: 'bar',
                            data: {
                                labels: years,
                                datasets: [
                                    {
                                        label: '瀬底',
                                        data: extremeData.hot_days.sesoko.map(d => d.days),
                                        backgroundColor: chartColors.sesoko + '99',
                                        borderColor: chartColors.sesoko,
                                        borderWidth: 1
                                    },
                                    {
                                        label: '万座',
                                        data: extremeData.hot_days.manza.map(d => d.days),
                                        backgroundColor: chartColors.manza + '99',
                                        borderColor: chartColors.manza,
                                        borderWidth: 1
                                    },
                                    {
                                        label: '小笠原',
                                        data: extremeData.hot_days.ogasawara.map(d => d.days),
                                        backgroundColor: chartColors.ogasawara + '99',
                                        borderColor: chartColors.ogasawara,
                                        borderWidth: 1
                                    }
                                ]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: { display: false },
                                    tooltip: {
                                        callbacks: {
                                            label: (ctx) => `${ctx.dataset.label}: ${ctx.raw}日`
                                        }
                                    }
                                },
                                scales: {
                                    x: {
                                        grid: { display: false },
                                        ticks: {
                                            callback: function(val, idx) {
                                                const year = years[idx];
                                                return year % 5 === 0 ? year : '';
                                            }
                                        }
                                    },
                                    y: {
                                        min: 0,
                                        grid: { color: '#e2e8f0' },
                                        ticks: {
                                            callback: (val) => val + '日'
                                        }
                                    }
                                }
                            }
                        });
                    })
                    .catch(err => console.error('Error loading extreme days data:', err));
            }
            
            
            // Mini extreme chart for six-card
            const extremeMiniCtx = document.getElementById('extremeChartMini');
            if (extremeMiniCtx) {
                fetch('data/extreme_days.json')
                    .then(res => res.json())
                    .then(extremeData => {
                        const years = extremeData.hot_days.sesoko.map(d => d.year).slice(-5);
                        const sesokoData = extremeData.hot_days.sesoko.slice(-5).map(d => d.days);
                        const manzaData = extremeData.hot_days.manza.slice(-5).map(d => d.days);
                        const ogasawaraData = extremeData.hot_days.ogasawara.slice(-5).map(d => d.days);
                        
                        new Chart(extremeMiniCtx, {
                            type: 'bar',
                            data: {
                                labels: years,
                                datasets: [
                                    { data: sesokoData, backgroundColor: '#5b9a94' },
                                    { data: manzaData, backgroundColor: '#c4a35a' },
                                    { data: ogasawaraData, backgroundColor: '#7a8a9a' }
                                ]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: { legend: { display: false } },
                                scales: {
                                    x: { display: true, grid: { display: false }, ticks: { font: { size: 9 } } },
                                    y: { display: false, min: 0 }
                                }
                            }
                        });
                    });
            }
            
            console.log('✅ Charts initialized');
        } catch (error) {
            console.error('Chart initialization error:', error);
        }
    }
    
    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initCharts);
    } else {
        initCharts();
    }
})();
</script>
</body>
</html>
